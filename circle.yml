machine:
  ruby:
    version: 2.4.0

general:
  artifacts:
    - "./_site"
    - "./_preview"

test:
  override:
    - bundle exec jekyll build -V -t --config _config.yml _config_staging.yml
    - bundle exec jekyll build -V -t --config _config.yml -b /0/home/ubuntu/beautyjoy.github.io/_preview/ -d ./_preview/
    # Use this to detect if coming from a PR
    # - if [[ ! -z $CI_PULL_REQUEST ]] ; then <long-running-command> ; fi

deployment:
  production:
    branch: master
    commands:
      - bundle exec s3_website push
